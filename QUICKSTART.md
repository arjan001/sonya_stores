# ðŸš€ Getting Started with Sonya Stores + Neon

## Quick Start Checklist

### 1. Environment Setup âœ…
- [ ] Set `DATABASE_URL` pointing to your Neon database
- [ ] Set `OPENAI_API_KEY` for AI product generation
- [ ] Set `JWT_SECRET` for admin authentication
- [ ] Run `pnpm install` to install dependencies

### 2. Database Verification âœ…
```bash
# Test Neon connection
pnpm db:check
# OR manually:
psql $DATABASE_URL -c "SELECT version();"
```

### 3. Generate Products âœ…
```bash
# Generate and seed 50+ AI products in 5 categories
pnpm seed:ai-products

# Watch for output:
# ðŸ¤– Generating AI products...
# âœ… Generated 10 products for Footwear
# âœ… Generated 10 products for Home Decor
# ... (etc)
# ðŸ’¾ Seeding database...
# âœ… Successfully inserted 50 products!
```

### 4. Start Development âœ…
```bash
pnpm dev
# Open http://localhost:3000
```

### 5. Test Admin Panel âœ…
```
1. Go to http://localhost:3000/admin
2. Click "Create Setup Account" (first time only)
3. Enter: Email, password, name
4. Login with those credentials
5. Navigate to "Products" â†’ Should see 50+ AI-generated products
6. Click "Categories" â†’ Should see 5 categories
```

### 6. Test Frontend âœ…
```
1. Go to http://localhost:3000
2. Should see featured products (from Neon)
3. Click "Footwear" category
4. Browse shoes generated by AI
5. Click product â†’ See detailed page
6. Try checkout flow (orders saved to Neon)
```

## What Changed from Supabase

| Aspect | Before (Supabase) | After (Neon) |
|--------|------------------|------------|
| **Database** | Managed Supabase PG | Direct Neon PG |
| **Connection** | `@supabase/supabase-js` | `pg` package |
| **Auth** | Supabase Auth | Custom JWT + cookies |
| **Product Data** | Supabase tables | Neon tables (same schema) |
| **Admin Panel** | Supabase auth | PostgreSQL admins table |
| **Data Fetching** | `/lib/supabase-data.ts` (now uses Neon) | Same file (now uses `/lib/db.ts`) |
| **API Routes** | Supabase client | PostgreSQL queries |

**KEY:** The module names stayed the same (`supabase-data.ts`) for backward compatibility, but they now use Neon under the hood!

## Neon Features You're Using

âœ… **Connection Pooling** - Automatic via `pg` Pool  
âœ… **SSL/TLS** - Enabled by default (sslmode=require)  
âœ… **Branching** - Create dev/test branches in Neon dashboard  
âœ… **Auto-scaling** - Compute auto-pauses when idle  
âœ… **Point-in-Time Recovery** - Available for backups  
âœ… **Monitoring** - Dashboard shows queries & performance  

## Database Architecture

```
Neon Project (sonya_stores)
â”œâ”€â”€ public schema
â”‚   â”œâ”€â”€ categories (5 rows: Footwear, Home Decor, Bedding, Lighting, Wall Art)
â”‚   â”œâ”€â”€ products (50+ rows: AI-generated)
â”‚   â”œâ”€â”€ orders (customer orders)
â”‚   â”œâ”€â”€ order_items (line items)
â”‚   â”œâ”€â”€ admins (user: super_admin)
â”‚   â”œâ”€â”€ newsletter_subscribers
â”‚   â”œâ”€â”€ delivery_settings
â”‚   â”œâ”€â”€ offers
â”‚   â”œâ”€â”€ policies
â”‚   â””â”€â”€ settings
â”œâ”€â”€ neon_auth schema (Stack/external auth tables - not used)
â””â”€â”€ pg_* system schemas
```

## Key Commands Reference

```bash
# Development
pnpm dev                      # Start dev server

# Database & Products
pnpm seed:ai-products        # Generate & seed 50+ products
pnpm db:check               # Verify Neon connection (if added)

# Building & Deployment
pnpm build                   # Build for production
pnpm start                   # Run production server
pnpm lint                    # Run linting

# Admin Access
# Go to http://localhost:3000/admin
# First time: Register admin account
# Login: Use your email/password
```

## Verification Checklist

Run this after setup to verify everything works:

```bash
# 1. Check database connection
psql $DATABASE_URL -c "SELECT COUNT(*) as product_count FROM products;" 

# 2. Check categories
psql $DATABASE_URL -c "SELECT name FROM categories ORDER BY name;"

# 3. Check admins
psql $DATABASE_URL -c "SELECT email, role FROM admins;"

# 4. Check orders table (should be empty initially)
psql $DATABASE_URL -c "SELECT COUNT(*) as order_count FROM orders;"
```

Expected output:
```
 product_count
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        50+     âœ“ (or higher after seeding)

 name
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 Bedding & Linens  âœ“
 Footwear          âœ“
 Home Decor        âœ“
 Lighting          âœ“
 Wall Art          âœ“

 email            | role
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 admin@example... | super_admin âœ“

 order_count
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        0     âœ“ (no orders yet)
```

## Troubleshooting Quick Links

| Issue | Solution |
|-------|----------|
| `DATABASE_URL not set` | Add to `.env.local`: `DATABASE_URL=postgresql://...` |
| Products don't show | Run: `pnpm seed:ai-products` |
| Admin login fails | Clear cookies, restart dev server |
| AI generation errors | Check `OPENAI_API_KEY` is set and valid |
| "Cannot find module pg" | Run: `pnpm install` |
| Database connection refused | Check Neon IP whitelist, verify URL correct |

## API Endpoints Reference

All endpoints now use Neon PostgreSQL (via `@/lib/db`):

```
GET  /api/products              â†’ List all products
GET  /api/products/[slug]       â†’ Get product by slug
GET  /api/categories            â†’ List categories
GET  /api/delivery-locations    â†’ Shipping options
GET  /api/site-data             â†’ Theme & settings
POST /api/orders                â†’ Create order
GET  /api/orders/[id]           â†’ Get order details
POST /api/newsletter             â†’ Subscribe to newsletter
GET  /api/track-order           â†’ Track order by number

ADMIN:
GET  /api/admin/dashboard       â†’ Dashboard stats
GET  /api/admin/users           â†’ List admin users
POST /api/admin/users/invite    â†’ Add new admin
GET  /api/admin/products        â†’ Products list (admin)
GET  /api/admin/seo             â†’ SEO settings
GET  /api/admin/hero-banners    â†’ Homepage banners
```

All routes query Neon database directly.

## Next: Deploy to Production

1. **Set Vercel Environment Variables**
   ```
   DATABASE_URL = [your-neon-url]
   OPENAI_API_KEY = [your-key]
   JWT_SECRET = [generate-secure-random]
   ```

2. **Deploy**
   ```bash
   git push origin main  # Deploys to Vercel
   ```

3. **Verify Production**
   - Check `/admin` works
   - Verify products display
   - Test checkout

## Support & Resources

- **Neon Docs**: https://neon.tech/docs
- **PostgreSQL Docs**: https://www.postgresql.org/docs/
- **AI SDK 6 Guide**: `/NEON_INTEGRATION.md`
- **Seed Script Guide**: `/SEED_PRODUCTS.md`

---

**You're all set! ðŸŽ‰**

Start with:
```bash
pnpm dev
# Then: pnpm seed:ai-products
```
